<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AjayaDesign ‚Äî Admin Dashboard</title>
  <meta name="robots" content="noindex, nofollow">
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;500;600;700&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: {
            mono: ['JetBrains Mono', 'monospace'],
            sans: ['Inter', 'sans-serif'],
          },
          colors: {
            'surface':     '#06060A',
            'surface-1':   '#0C0C12',
            'surface-2':   '#12121A',
            'surface-3':   '#1A1A24',
            'border':      '#2A2A3A',
            'border-glow': '#3A3A5A',
            'amd-red':     '#ED1C24',
            'brand-btn':   '#991B1B',
            'brand-link':  '#FF6B6B',
            'electric':    '#00D4FF',
            'electric-dim':'#0099BB',
            'neon-green':  '#00FF88',
            'neon-yellow': '#FFD600',
            'neon-orange': '#FF8A00',
            'neon-purple': '#A855F7',
          },
          animation: {
            'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
            'glow': 'glow 2s ease-in-out infinite alternate',
            'slide-up': 'slideUp 0.3s ease-out',
            'fade-in': 'fadeIn 0.4s ease-out',
          },
          keyframes: {
            glow: {
              '0%': { boxShadow: '0 0 5px rgba(0,212,255,0.2)' },
              '100%': { boxShadow: '0 0 20px rgba(0,212,255,0.4)' },
            },
            slideUp: {
              '0%': { opacity: '0', transform: 'translateY(10px)' },
              '100%': { opacity: '1', transform: 'translateY(0)' },
            },
            fadeIn: {
              '0%': { opacity: '0' },
              '100%': { opacity: '1' },
            },
          },
        }
      }
    }
  </script>
  <style>
    /* Custom scrollbar */
    ::-webkit-scrollbar { width: 6px; height: 6px; }
    ::-webkit-scrollbar-track { background: #0C0C12; }
    ::-webkit-scrollbar-thumb { background: #2A2A3A; border-radius: 3px; }
    ::-webkit-scrollbar-thumb:hover { background: #3A3A5A; }

    /* Terminal log styles */
    .log-line { font-size: 0.8rem; line-height: 1.6; }
    .log-line:hover { background: rgba(255,255,255,0.03); }
    .log-step { color: #00D4FF; font-weight: 600; }
    .log-ai { color: #A855F7; }
    .log-test-pass { color: #00FF88; }
    .log-test-fail { color: #FF6B6B; }
    .log-deploy { color: #FFD600; }
    .log-error { color: #FF6B6B; opacity: 0.9; }
    .log-dim { opacity: 0.5; }

    /* Step progress */
    .step-dot { transition: all 0.3s ease; }
    .step-dot.active { box-shadow: 0 0 12px rgba(0,212,255,0.6); }
    .step-dot.done { box-shadow: 0 0 8px rgba(0,255,136,0.4); }
    .step-connector { transition: background 0.5s ease; }

    /* AI chat bubbles */
    .ai-bubble { animation: slideUp 0.3s ease-out; }

    /* Glass effect */
    .glass { background: rgba(12,12,18,0.8); backdrop-filter: blur(12px); }

    /* Sidebar item hover */
    .build-item { transition: all 0.15s ease; }
    .build-item:hover { background: rgba(255,255,255,0.04); }
    .build-item.selected { background: rgba(0,212,255,0.08); border-color: #00D4FF; }

    /* Hide scrollbar for sidebar on mobile */
    .no-scrollbar::-webkit-scrollbar { display: none; }
    .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }

    /* Pulsing dot for active builds */
    @keyframes live-pulse {
      0%, 100% { opacity: 1; transform: scale(1); }
      50% { opacity: 0.5; transform: scale(1.5); }
    }
    .live-dot { animation: live-pulse 1.5s ease-in-out infinite; }

    /* ‚ïê‚ïê‚ïê Pipeline Graph Styles ‚ïê‚ïê‚ïê */
    .pipeline-container { position: relative; }

    .pipe-node {
      position: relative;
      padding: 0.75rem 1rem;
      border-radius: 0.75rem;
      border: 1px solid #2A2A3A;
      background: #0C0C12;
      transition: all 0.4s cubic-bezier(0.16, 1, 0.3, 1);
      animation: fadeIn 0.4s ease-out;
    }
    .pipe-node.pending { opacity: 0.3; border-color: #1A1A24; }
    .pipe-node.active {
      border-color: #00D4FF;
      box-shadow: 0 0 20px rgba(0,212,255,0.15), inset 0 0 20px rgba(0,212,255,0.03);
    }
    .pipe-node.done {
      border-color: rgba(0,255,136,0.3);
      background: rgba(0,255,136,0.03);
    }
    .pipe-node.failed {
      border-color: rgba(255,107,107,0.4);
      background: rgba(255,107,107,0.03);
    }

    /* Vertical connector lines */
    .pipe-connector {
      width: 2px;
      margin: 0 auto;
      background: #1A1A24;
      transition: background 0.5s ease;
    }
    .pipe-connector.lit { background: linear-gradient(180deg, rgba(0,255,136,0.5), rgba(0,212,255,0.3)); }
    .pipe-connector.lit-fail { background: linear-gradient(180deg, rgba(255,107,107,0.4), rgba(255,107,107,0.2)); }

    /* Fork/join connectors */
    .pipe-fork {
      position: relative;
      display: flex;
      justify-content: center;
    }
    .pipe-fork::before {
      content: '';
      position: absolute;
      top: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 2px;
      height: 12px;
      background: inherit;
    }
    .pipe-fork-line {
      position: absolute;
      top: 12px;
      height: 2px;
      background: #1A1A24;
      transition: background 0.5s ease;
    }
    .pipe-fork-line.lit { background: rgba(0,212,255,0.3); }

    /* Branch drop lines */
    .pipe-branch-drop {
      width: 2px;
      height: 12px;
      margin: 0 auto;
      background: #1A1A24;
      transition: background 0.5s ease;
    }
    .pipe-branch-drop.lit { background: rgba(0,212,255,0.3); }

    /* Pulse animation for active nodes */
    @keyframes node-pulse {
      0%, 100% { box-shadow: 0 0 20px rgba(0,212,255,0.15); }
      50% { box-shadow: 0 0 30px rgba(0,212,255,0.3); }
    }
    .pipe-node.active { animation: node-pulse 2s ease-in-out infinite; }

    /* Agent grid cards */
    .agent-card {
      border-radius: 0.5rem;
      border: 1px solid #2A2A3A;
      background: #12121A;
      padding: 0.5rem 0.75rem;
      font-size: 0.75rem;
      transition: all 0.3s ease;
    }
    .agent-card.pending { opacity: 0.25; }
    .agent-card.active { border-color: #00D4FF; box-shadow: 0 0 12px rgba(0,212,255,0.1); }
    .agent-card.done { border-color: rgba(0,255,136,0.3); }
    .agent-card.failed { border-color: rgba(255,107,107,0.3); }

    /* Council debate bubbles */
    .council-bubble {
      border-radius: 0.75rem;
      padding: 0.6rem 0.8rem;
      font-size: 0.75rem;
      animation: slideUp 0.3s ease-out;
    }
    .council-bubble.strategist { background: rgba(0,212,255,0.08); border-left: 3px solid #00D4FF; }
    .council-bubble.critic { background: rgba(168,85,247,0.08); border-left: 3px solid #A855F7; }

    /* Retry pulse */
    @keyframes retry-shake {
      0%, 100% { transform: translateX(0); }
      20% { transform: translateX(-2px); }
      40% { transform: translateX(2px); }
      60% { transform: translateX(-1px); }
      80% { transform: translateX(1px); }
    }
    .retry-shake { animation: retry-shake 0.4s ease-in-out; }
  </style>
</head>
<body class="bg-surface text-gray-300 font-sans antialiased h-screen overflow-hidden">

  <!-- ‚ïê‚ïê‚ïê Top Bar ‚ïê‚ïê‚ïê -->
  <header class="h-14 bg-surface-1 border-b border-border flex items-center justify-between px-4 z-50 relative">
    <div class="flex items-center gap-3">
      <div class="w-8 h-8 rounded-lg bg-gradient-to-br from-amd-red to-electric flex items-center justify-center">
        <span class="text-white font-mono font-bold text-sm">A</span>
      </div>
      <h1 class="font-mono font-semibold text-white text-sm tracking-wide">AjayaDesign<span class="text-electric">::</span>Admin</h1>
    </div>
    <div class="flex items-center gap-4">
      <button onclick="openAddClientModal()" class="flex items-center gap-1.5 px-3 py-1.5 bg-electric/10 text-electric border border-electric/30 rounded-lg font-mono text-xs font-semibold hover:bg-electric/20 transition">
        ‚ûï Add Client
      </button>
      <div id="connection-status" class="flex items-center gap-2 text-xs font-mono">
        <span class="w-2 h-2 rounded-full bg-gray-600" id="conn-dot"></span>
        <span id="conn-text" class="text-gray-500">Disconnected</span>
      </div>
      <a href="/" class="text-xs font-mono text-gray-500 hover:text-electric transition">‚Üê Site</a>
      <button onclick="signOut()" class="text-xs font-mono text-gray-500 hover:text-brand-link transition">Sign Out</button>
    </div>
  </header>

  <!-- ‚ïê‚ïê‚ïê Main Layout ‚ïê‚ïê‚ïê -->
  <div class="flex h-[calc(100vh-3.5rem)]">

    <!-- ‚ïê‚ïê‚ïê Sidebar ‚ïê‚ïê‚ïê -->
    <aside id="sidebar" class="w-72 min-w-[18rem] bg-surface-1 border-r border-border flex flex-col">
      <!-- Tab Switcher -->
      <div class="flex border-b border-border">
        <button onclick="switchTab('builds')" id="tab-builds"
          class="flex-1 py-3 text-xs font-mono font-semibold uppercase tracking-widest text-center border-b-2 border-electric text-electric transition">
          üî® Builds
        </button>
        <button onclick="switchTab('leads')" id="tab-leads"
          class="flex-1 py-3 text-xs font-mono font-semibold uppercase tracking-widest text-center border-b-2 border-transparent text-gray-500 hover:text-gray-300 transition">
          üì¨ Leads <span id="stat-leads" class="ml-1 px-1.5 py-0.5 rounded-full bg-electric/20 text-electric text-[0.6rem]">0</span>
        </button>
        <button onclick="switchTab('portfolio')" id="tab-portfolio"
          class="flex-1 py-3 text-xs font-mono font-semibold uppercase tracking-widest text-center border-b-2 border-transparent text-gray-500 hover:text-gray-300 transition">
          üìÅ Portfolio
        </button>
        <button onclick="switchTab('history')" id="tab-history"
          class="flex-1 py-3 text-xs font-mono font-semibold uppercase tracking-widest text-center border-b-2 border-transparent text-gray-500 hover:text-gray-300 transition">
          üìú History
        </button>
      </div>

      <!-- Builds Tab -->
      <div id="builds-tab" class="flex-1 flex flex-col overflow-hidden">
        <!-- Stats -->
        <div class="p-4 border-b border-border">
          <div class="flex items-center justify-between mb-3">
            <h2 class="font-mono text-xs font-semibold text-gray-400 uppercase tracking-widest">History</h2>
            <button onclick="refreshBuilds()" class="text-gray-500 hover:text-electric transition" title="Refresh">
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/></svg>
            </button>
          </div>
          <div class="grid grid-cols-3 gap-2">
            <div class="bg-surface-2 rounded-lg p-2 text-center">
              <div id="stat-total" class="font-mono text-lg font-bold text-white">0</div>
              <div class="text-[0.65rem] text-gray-500 uppercase">Total</div>
            </div>
            <div class="bg-surface-2 rounded-lg p-2 text-center">
              <div id="stat-success" class="font-mono text-lg font-bold text-neon-green">0</div>
              <div class="text-[0.65rem] text-gray-500 uppercase">Pass</div>
            </div>
            <div class="bg-surface-2 rounded-lg p-2 text-center">
              <div id="stat-failed" class="font-mono text-lg font-bold text-brand-link">0</div>
              <div class="text-[0.65rem] text-gray-500 uppercase">Fail</div>
            </div>
          </div>
        </div>
        <!-- Build List -->
        <div id="build-list" class="flex-1 overflow-y-auto no-scrollbar p-2 space-y-1">
          <div class="text-center text-gray-600 text-xs font-mono py-8">Loading builds...</div>
        </div>
      </div>

      <!-- Leads Tab (hidden initially) -->
      <div id="leads-panel" class="flex-1 overflow-hidden hidden flex flex-col">
        <div class="p-4 border-b border-border">
          <h2 class="font-mono text-xs font-semibold text-gray-400 uppercase tracking-widest">Client Requests</h2>
        </div>
        <!-- Active / Archived sub-tabs -->
        <div class="flex border-b border-border bg-surface-1">
          <button onclick="switchLeadsSubTab('active')" id="leads-subtab-active"
            class="flex-1 py-2 text-[0.65rem] font-mono font-semibold uppercase tracking-widest text-center border-b-2 border-electric text-electric transition">
            Active <span id="stat-leads-active" class="ml-1 px-1.5 py-0.5 rounded-full bg-electric/20 text-electric text-[0.55rem]">0</span>
          </button>
          <button onclick="switchLeadsSubTab('archived')" id="leads-subtab-archived"
            class="flex-1 py-2 text-[0.65rem] font-mono font-semibold uppercase tracking-widest text-center border-b-2 border-transparent text-gray-500 hover:text-gray-300 transition">
            Archived <span id="stat-leads-archived" class="ml-1 px-1.5 py-0.5 rounded-full bg-gray-800 text-gray-500 text-[0.55rem]">0</span>
          </button>
        </div>
        <!-- Active leads list -->
        <div id="leads-panel-content" class="flex-1 overflow-y-auto no-scrollbar p-3 space-y-3">
          <div class="text-center text-gray-600 text-xs font-mono py-8">Loading leads...</div>
        </div>
        <!-- Archived leads list (hidden initially) -->
        <div id="archived-panel-content" class="flex-1 overflow-y-auto no-scrollbar p-3 space-y-3 hidden">
          <div class="text-center text-gray-600 text-xs font-mono py-8">No archived leads</div>
        </div>
      </div>

      <!-- Portfolio Tab (hidden initially) -->
      <div id="portfolio-panel" class="flex-1 overflow-hidden hidden flex flex-col">
        <div class="p-4 border-b border-border">
          <div class="flex items-center justify-between">
            <h2 class="font-mono text-xs font-semibold text-gray-400 uppercase tracking-widest">Finished Sites</h2>
            <button onclick="seedPortfolioSites()" class="text-[0.65rem] font-mono px-2 py-1 rounded bg-neon-green/10 text-neon-green hover:bg-neon-green/20 transition" title="Seed existing sites">
              üå± Seed
            </button>
          </div>
        </div>
        <!-- Portfolio sub-tabs -->
        <div class="flex border-b border-border bg-surface-1">
          <button onclick="switchPortfolioSubTab('sites')" id="portfolio-subtab-sites"
            class="flex-1 py-2 text-[0.65rem] font-mono font-semibold uppercase tracking-widest text-center border-b-2 border-electric text-electric transition">
            üåê Sites
          </button>
          <button onclick="switchPortfolioSubTab('contracts')" id="portfolio-subtab-contracts"
            class="flex-1 py-2 text-[0.65rem] font-mono font-semibold uppercase tracking-widest text-center border-b-2 border-transparent text-gray-500 hover:text-gray-300 transition">
            üìù Contracts
          </button>
          <button onclick="switchPortfolioSubTab('invoices')" id="portfolio-subtab-invoices"
            class="flex-1 py-2 text-[0.65rem] font-mono font-semibold uppercase tracking-widest text-center border-b-2 border-transparent text-gray-500 hover:text-gray-300 transition">
            üí∞ Invoices
          </button>
        </div>
        <!-- Sites list -->
        <div id="portfolio-sites-list" class="flex-1 overflow-y-auto no-scrollbar p-3 space-y-3">
          <div class="text-center text-gray-600 text-xs font-mono py-8">Loading portfolio...</div>
        </div>
        <!-- Contracts list (hidden) -->
        <div id="portfolio-contracts-list" class="flex-1 overflow-y-auto no-scrollbar p-3 space-y-3 hidden">
          <div class="text-center text-gray-600 text-xs font-mono py-8">Loading contracts...</div>
        </div>
        <!-- Invoices list (hidden) -->
        <div id="portfolio-invoices-list" class="flex-1 overflow-y-auto no-scrollbar p-3 space-y-3 hidden">
          <div class="text-center text-gray-600 text-xs font-mono py-8">Loading invoices...</div>
        </div>
      </div>

      <!-- History Tab (hidden initially) -->
      <div id="history-panel" class="flex-1 overflow-hidden hidden flex flex-col">
        <div class="p-4 border-b border-border">
          <div class="flex items-center justify-between">
            <h2 class="font-mono text-xs font-semibold text-gray-400 uppercase tracking-widest">Activity Trail</h2>
            <button onclick="loadActivityLog()" class="text-gray-500 hover:text-electric transition" title="Refresh">
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/></svg>
            </button>
          </div>
        </div>
        <!-- Filter sub-tabs -->
        <div class="flex border-b border-border bg-surface-1">
          <button onclick="filterActivityLog('all')" id="history-filter-all"
            class="flex-1 py-2 text-[0.65rem] font-mono font-semibold uppercase tracking-widest text-center border-b-2 border-electric text-electric transition">
            All
          </button>
          <button onclick="filterActivityLog('contract')" id="history-filter-contract"
            class="flex-1 py-2 text-[0.65rem] font-mono font-semibold uppercase tracking-widest text-center border-b-2 border-transparent text-gray-500 hover:text-gray-300 transition">
            üìù Contracts
          </button>
          <button onclick="filterActivityLog('invoice')" id="history-filter-invoice"
            class="flex-1 py-2 text-[0.65rem] font-mono font-semibold uppercase tracking-widest text-center border-b-2 border-transparent text-gray-500 hover:text-gray-300 transition">
            üí∞ Invoices
          </button>
        </div>
        <!-- Activity timeline -->
        <div id="history-list" class="flex-1 overflow-y-auto no-scrollbar p-3 space-y-1">
          <div class="text-center text-gray-600 text-xs font-mono py-8">Loading activity...</div>
        </div>
      </div>
    </aside>

    <!-- ‚ïê‚ïê‚ïê Main Content ‚ïê‚ïê‚ïê -->
    <main class="flex-1 flex flex-col overflow-hidden">

      <!-- No Build Selected State -->
      <div id="empty-state" class="flex-1 flex items-center justify-center">
        <div class="text-center">
          <div class="text-6xl mb-4 opacity-20">üîß</div>
          <h2 class="font-mono text-xl text-gray-500 mb-2">No build selected</h2>
          <p class="text-sm text-gray-600">Select a build from the sidebar or wait for a new one</p>
        </div>
      </div>

      <!-- Lead Detail (hidden initially) -->
      <div id="lead-detail" class="flex-1 flex flex-col overflow-hidden hidden">

        <!-- Lead Header -->
        <div class="p-6 bg-surface-1 border-b border-border">
          <div class="flex items-center justify-between mb-4">
            <div class="flex items-center gap-3">
              <span id="lead-status-badge" class="px-2.5 py-1 rounded-full text-xs font-mono font-semibold"></span>
              <h2 id="lead-business" class="font-mono text-xl font-bold text-white"></h2>
            </div>
            <div class="flex items-center gap-2">
              <select id="lead-status-select" onchange="updateLeadStatusFromDetail(this.value)"
                class="text-xs font-mono px-3 py-1.5 rounded-lg bg-surface-2 border border-border text-gray-300 cursor-pointer focus:border-electric focus:outline-none">
                <option value="new">NEW</option>
                <option value="contacted">CONTACTED</option>
                <option value="building">BUILDING</option>
                <option value="deployed">DEPLOYED</option>
                <option value="archived">ARCHIVED</option>
              </select>
            </div>
          </div>
          <div id="lead-meta" class="flex gap-6 text-sm text-gray-400"></div>
        </div>

        <!-- Lead Content -->
        <div class="flex-1 overflow-y-auto p-6">
          <!-- Goals Section -->
          <div class="mb-8">
            <h3 class="font-mono text-xs font-semibold text-gray-400 uppercase tracking-widest mb-3">üìã Project Goals</h3>
            <div id="lead-goals" class="bg-surface-2 rounded-xl border border-border p-5 text-sm text-gray-300 leading-relaxed"></div>
          </div>

          <!-- Info Grid -->
          <div class="grid grid-cols-2 gap-4 mb-4">
            <div class="bg-surface-2 rounded-xl border border-border p-4">
              <div class="text-[0.65rem] font-mono text-gray-600 uppercase tracking-widest mb-1">Email</div>
              <div id="lead-email" class="text-sm text-electric font-mono"></div>
            </div>
            <div class="bg-surface-2 rounded-xl border border-border p-4">
              <div class="text-[0.65rem] font-mono text-gray-600 uppercase tracking-widest mb-1">Niche</div>
              <div id="lead-niche" class="text-sm text-gray-300"></div>
            </div>
            <div class="bg-surface-2 rounded-xl border border-border p-4">
              <div class="text-[0.65rem] font-mono text-gray-600 uppercase tracking-widest mb-1">Submitted</div>
              <div id="lead-time" class="text-sm text-gray-300"></div>
            </div>
            <div class="bg-surface-2 rounded-xl border border-border p-4">
              <div class="text-[0.65rem] font-mono text-gray-600 uppercase tracking-widest mb-1">Source</div>
              <div id="lead-source" class="text-sm text-gray-300 font-mono"></div>
            </div>
          </div>

          <!-- Extended Fields (populated by JS) -->
          <div id="lead-extra-fields" class="mb-8"></div>

          <!-- Actions -->
          <div>
            <h3 class="font-mono text-xs font-semibold text-gray-400 uppercase tracking-widest mb-3">‚ö° Actions</h3>
            <div class="flex gap-3">
              <button onclick="triggerBuildForLead()" class="inline-flex items-center gap-2 px-5 py-2.5 bg-electric/10 text-electric border border-electric/30 rounded-lg font-mono text-sm font-semibold hover:bg-electric/20 transition">
                üöÄ Trigger Build
              </button>
              <a id="lead-email-link" href="" class="inline-flex items-center gap-2 px-5 py-2.5 bg-surface-2 text-gray-300 border border-border rounded-lg font-mono text-sm hover:border-border-glow transition">
                ‚úâÔ∏è Send Email
              </a>
              <button id="btn-archive-lead" onclick="archiveLead()" class="inline-flex items-center gap-2 px-5 py-2.5 bg-surface-2 text-gray-500 border border-border rounded-lg font-mono text-sm hover:text-brand-link hover:border-brand-link/30 transition">
                üóÉÔ∏è Archive
              </button>
              <button id="btn-restore-lead" onclick="restoreLead()" class="hidden inline-flex items-center gap-2 px-5 py-2.5 bg-neon-green/10 text-neon-green border border-neon-green/30 rounded-lg font-mono text-sm hover:bg-neon-green/20 transition">
                ‚ôªÔ∏è Restore
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- ‚ïê‚ïê‚ïê Portfolio Site Detail (hidden initially) ‚ïê‚ïê‚ïê -->
      <div id="portfolio-detail" class="flex-1 flex flex-col overflow-hidden hidden">
        <div class="p-6 bg-surface-1 border-b border-border">
          <div class="flex items-center justify-between mb-4">
            <div class="flex items-center gap-3">
              <span class="px-2.5 py-1 rounded-full text-xs font-mono font-semibold bg-neon-green/20 text-neon-green">DEPLOYED</span>
              <h2 id="pf-client-name" class="font-mono text-xl font-bold text-white"></h2>
            </div>
            <div class="flex items-center gap-2">
              <button onclick="savePortfolioEdit()" class="text-xs font-mono px-3 py-1.5 rounded-lg bg-neon-green/10 text-neon-green border border-neon-green/30 hover:bg-neon-green/20 transition">üíæ Save</button>
              <button onclick="createContractForSite()" class="text-xs font-mono px-3 py-1.5 rounded-lg bg-electric/10 text-electric border border-electric/30 hover:bg-electric/20 transition">üìù New Contract</button>
              <button onclick="createInvoiceForSite()" class="text-xs font-mono px-3 py-1.5 rounded-lg bg-neon-purple/10 text-neon-purple border border-neon-purple/30 hover:bg-neon-purple/20 transition">üí∞ New Invoice</button>
            </div>
          </div>
          <div id="pf-meta" class="flex gap-6 text-sm text-gray-400"></div>
        </div>
        <div class="flex-1 overflow-y-auto p-6 space-y-6">
          <!-- Editable Fields Grid -->
          <div>
            <h3 class="font-mono text-xs font-semibold text-gray-400 uppercase tracking-widest mb-3">üìã Client Details</h3>
            <div class="grid grid-cols-2 gap-4">
              <div class="bg-surface-2 rounded-xl border border-border p-4">
                <label class="text-[0.65rem] font-mono text-gray-600 uppercase tracking-widest mb-1 block">Client Name</label>
                <input id="pf-edit-name" class="w-full bg-transparent border-b border-border text-sm text-white font-mono focus:border-electric focus:outline-none py-1" />
              </div>
              <div class="bg-surface-2 rounded-xl border border-border p-4">
                <label class="text-[0.65rem] font-mono text-gray-600 uppercase tracking-widest mb-1 block">Email</label>
                <input id="pf-edit-email" class="w-full bg-transparent border-b border-border text-sm text-white font-mono focus:border-electric focus:outline-none py-1" />
              </div>
              <div class="bg-surface-2 rounded-xl border border-border p-4">
                <label class="text-[0.65rem] font-mono text-gray-600 uppercase tracking-widest mb-1 block">Phone</label>
                <input id="pf-edit-phone" class="w-full bg-transparent border-b border-border text-sm text-white font-mono focus:border-electric focus:outline-none py-1" />
              </div>
              <div class="bg-surface-2 rounded-xl border border-border p-4">
                <label class="text-[0.65rem] font-mono text-gray-600 uppercase tracking-widest mb-1 block">Niche</label>
                <input id="pf-edit-niche" class="w-full bg-transparent border-b border-border text-sm text-white font-mono focus:border-electric focus:outline-none py-1" />
              </div>
              <div class="bg-surface-2 rounded-xl border border-border p-4">
                <label class="text-[0.65rem] font-mono text-gray-600 uppercase tracking-widest mb-1 block">Location</label>
                <input id="pf-edit-location" class="w-full bg-transparent border-b border-border text-sm text-white font-mono focus:border-electric focus:outline-none py-1" />
              </div>
              <div class="bg-surface-2 rounded-xl border border-border p-4">
                <label class="text-[0.65rem] font-mono text-gray-600 uppercase tracking-widest mb-1 block">Live URL</label>
                <input id="pf-edit-url" class="w-full bg-transparent border-b border-border text-sm text-electric font-mono focus:border-electric focus:outline-none py-1" />
              </div>
              <div class="bg-surface-2 rounded-xl border border-border p-4">
                <label class="text-[0.65rem] font-mono text-gray-600 uppercase tracking-widest mb-1 block">Brand Colors</label>
                <input id="pf-edit-colors" class="w-full bg-transparent border-b border-border text-sm text-white font-mono focus:border-electric focus:outline-none py-1" />
              </div>
              <div class="bg-surface-2 rounded-xl border border-border p-4">
                <label class="text-[0.65rem] font-mono text-gray-600 uppercase tracking-widest mb-1 block">Tagline</label>
                <input id="pf-edit-tagline" class="w-full bg-transparent border-b border-border text-sm text-white font-mono focus:border-electric focus:outline-none py-1" />
              </div>
              <div class="col-span-2 bg-surface-2 rounded-xl border border-border p-4">
                <label class="text-[0.65rem] font-mono text-gray-600 uppercase tracking-widest mb-1 block">Goals</label>
                <textarea id="pf-edit-goals" rows="3" class="w-full bg-transparent border-b border-border text-sm text-gray-300 font-mono focus:border-electric focus:outline-none py-1 resize-none"></textarea>
              </div>
            </div>
          </div>
          <!-- Site Contracts -->
          <div id="pf-contracts-section">
            <h3 class="font-mono text-xs font-semibold text-gray-400 uppercase tracking-widest mb-3">üìù Contracts</h3>
            <div id="pf-contracts-list" class="space-y-2">
              <p class="text-xs text-gray-600 font-mono">No contracts yet</p>
            </div>
          </div>
          <!-- Site Invoices -->
          <div id="pf-invoices-section">
            <h3 class="font-mono text-xs font-semibold text-gray-400 uppercase tracking-widest mb-3">üí∞ Invoices</h3>
            <div id="pf-invoices-list" class="space-y-2">
              <p class="text-xs text-gray-600 font-mono">No invoices yet</p>
            </div>
          </div>
        </div>
      </div>

      <!-- ‚ïê‚ïê‚ïê Contract Detail / Builder (hidden initially) ‚ïê‚ïê‚ïê -->
      <div id="contract-detail" class="flex-1 flex flex-col overflow-hidden hidden">
        <div class="p-6 bg-surface-1 border-b border-border">
          <div class="flex items-center justify-between mb-2">
            <div class="flex items-center gap-3">
              <span id="ct-status-badge" class="px-2.5 py-1 rounded-full text-xs font-mono font-semibold bg-gray-800 text-gray-400">DRAFT</span>
              <h2 class="font-mono text-lg font-bold text-white">üìù Contract Builder</h2>
            </div>
            <div class="flex items-center gap-2">
              <button onclick="saveContract()" class="text-xs font-mono px-3 py-1.5 rounded-lg bg-neon-green/10 text-neon-green border border-neon-green/30 hover:bg-neon-green/20 transition">üíæ Save</button>
              <button onclick="sendContract()" class="text-xs font-mono px-3 py-1.5 rounded-lg bg-electric/10 text-electric border border-electric/30 hover:bg-electric/20 transition">üìß Send to Client</button>
              <button onclick="downloadContractPDF()" class="text-xs font-mono px-3 py-1.5 rounded-lg bg-neon-purple/10 text-neon-purple border border-neon-purple/30 hover:bg-neon-purple/20 transition">üìÑ Download PDF</button>
              <button onclick="logPastContractEvent()" class="text-xs font-mono px-3 py-1.5 rounded-lg bg-neon-yellow/10 text-neon-yellow border border-neon-yellow/30 hover:bg-neon-yellow/20 transition" title="Record a past event (sent via email, payment received, etc.)">üìú Log Event</button>
              <button id="ct-btn-delete" onclick="deleteContract()" class="hidden text-xs font-mono px-3 py-1.5 rounded-lg bg-red-500/10 text-red-400 border border-red-500/30 hover:bg-red-500/20 transition" title="Delete this draft contract">üóëÔ∏è Delete</button>
            </div>
          </div>
          <div id="ct-meta" class="text-xs font-mono text-gray-500"></div>
        </div>
        <div class="flex-1 overflow-y-auto p-6 space-y-6">
          <!-- Signed Contract View (populated by JS when status=signed) -->
          <div id="ct-signed-view" class="hidden"></div>

          <!-- Editable Form (hidden when signed) -->
          <div id="ct-editable-form">
          <!-- Client & Project Info -->
          <div class="grid grid-cols-2 gap-4">
            <div class="bg-surface-2 rounded-xl border border-border p-4">
              <label class="text-[0.65rem] font-mono text-gray-600 uppercase tracking-widest mb-1 block">Client Name *</label>
              <input id="ct-client-name" class="w-full bg-transparent border-b border-border text-sm text-white font-mono focus:border-electric focus:outline-none py-1" />
            </div>
            <div class="bg-surface-2 rounded-xl border border-border p-4">
              <label class="text-[0.65rem] font-mono text-gray-600 uppercase tracking-widest mb-1 block">Client Email *</label>
              <input id="ct-client-email" class="w-full bg-transparent border-b border-border text-sm text-white font-mono focus:border-electric focus:outline-none py-1" />
            </div>
            <div class="bg-surface-2 rounded-xl border border-border p-4">
              <label class="text-[0.65rem] font-mono text-gray-600 uppercase tracking-widest mb-1 block">Client Phone</label>
              <input id="ct-client-phone" class="w-full bg-transparent border-b border-border text-sm text-white font-mono focus:border-electric focus:outline-none py-1" />
            </div>
            <div class="bg-surface-2 rounded-xl border border-border p-4">
              <label class="text-[0.65rem] font-mono text-gray-600 uppercase tracking-widest mb-1 block">Client Address</label>
              <input id="ct-client-address" class="w-full bg-transparent border-b border-border text-sm text-white font-mono focus:border-electric focus:outline-none py-1" />
            </div>
            <div class="bg-surface-2 rounded-xl border border-border p-4">
              <label class="text-[0.65rem] font-mono text-gray-600 uppercase tracking-widest mb-1 block">Project Name *</label>
              <input id="ct-project-name" class="w-full bg-transparent border-b border-border text-sm text-white font-mono focus:border-electric focus:outline-none py-1" />
            </div>
            <div class="bg-surface-2 rounded-xl border border-border p-4">
              <label class="text-[0.65rem] font-mono text-gray-600 uppercase tracking-widest mb-1 block">Total Amount ($)</label>
              <input id="ct-total-amount" type="number" step="0.01" class="w-full bg-transparent border-b border-border text-sm text-neon-green font-mono focus:border-electric focus:outline-none py-1" />
            </div>
            <div class="bg-surface-2 rounded-xl border border-border p-4">
              <label class="text-[0.65rem] font-mono text-gray-600 uppercase tracking-widest mb-1 block">Deposit Amount ($)</label>
              <input id="ct-deposit-amount" type="number" step="0.01" class="w-full bg-transparent border-b border-border text-sm text-white font-mono focus:border-electric focus:outline-none py-1" />
            </div>
            <div class="bg-surface-2 rounded-xl border border-border p-4">
              <label class="text-[0.65rem] font-mono text-gray-600 uppercase tracking-widest mb-1 block">Payment Method</label>
              <select id="ct-payment-method" class="w-full bg-transparent border-b border-border text-sm text-white font-mono focus:border-electric focus:outline-none py-1">
                <option value="" class="bg-surface">Select...</option>
                <option value="venmo" class="bg-surface">Venmo</option>
                <option value="zelle" class="bg-surface">Zelle</option>
                <option value="paypal" class="bg-surface">PayPal</option>
                <option value="bank" class="bg-surface">Bank Transfer</option>
              </select>
            </div>
            <div class="bg-surface-2 rounded-xl border border-border p-4">
              <label class="text-[0.65rem] font-mono text-gray-600 uppercase tracking-widest mb-1 block">Start Date</label>
              <input id="ct-start-date" type="date" class="w-full bg-transparent border-b border-border text-sm text-white font-mono focus:border-electric focus:outline-none py-1" />
            </div>
            <div class="bg-surface-2 rounded-xl border border-border p-4">
              <label class="text-[0.65rem] font-mono text-gray-600 uppercase tracking-widest mb-1 block">Est. Completion</label>
              <input id="ct-completion-date" type="date" class="w-full bg-transparent border-b border-border text-sm text-white font-mono focus:border-electric focus:outline-none py-1" />
            </div>
            <div class="col-span-2 bg-surface-2 rounded-xl border border-border p-4">
              <label class="text-[0.65rem] font-mono text-gray-600 uppercase tracking-widest mb-1 block">Project Description</label>
              <textarea id="ct-project-desc" rows="3" class="w-full bg-transparent border-b border-border text-sm text-gray-300 font-mono focus:border-electric focus:outline-none py-1 resize-none"></textarea>
            </div>
            <div class="col-span-2 bg-surface-2 rounded-xl border border-border p-4">
              <label class="text-[0.65rem] font-mono text-gray-600 uppercase tracking-widest mb-1 block">Payment Terms</label>
              <textarea id="ct-payment-terms" rows="2" class="w-full bg-transparent border-b border-border text-sm text-gray-300 font-mono focus:border-electric focus:outline-none py-1 resize-none"></textarea>
            </div>
          </div>

          <!-- Clauses -->
          <div>
            <div class="flex items-center justify-between mb-3">
              <h3 class="font-mono text-xs font-semibold text-gray-400 uppercase tracking-widest">üìã Contract Clauses</h3>
              <div class="flex items-center gap-2">
                <button onclick="addCustomClause()" class="text-[0.65rem] font-mono px-2 py-1 rounded bg-electric/10 text-electric hover:bg-electric/20 transition">+ Add Clause</button>
                <button onclick="resetClausesToDefault()" class="text-[0.65rem] font-mono px-2 py-1 rounded bg-surface-2 text-gray-500 hover:text-gray-300 transition">‚Üª Reset Defaults</button>
              </div>
            </div>
            <div id="ct-clauses-container" class="space-y-3">
              <!-- Populated by JS -->
            </div>
          </div>

          <!-- Custom Notes -->
          <div>
            <h3 class="font-mono text-xs font-semibold text-gray-400 uppercase tracking-widest mb-3">üìù Custom Notes</h3>
            <textarea id="ct-custom-notes" rows="4" class="w-full bg-surface-2 rounded-xl border border-border p-4 text-sm text-gray-300 font-mono focus:border-electric focus:outline-none resize-none" placeholder="Additional terms or notes..."></textarea>
          </div>

          <!-- Signature Section (read-only, shows after signing) -->
          <div id="ct-signature-section" class="hidden">
            <h3 class="font-mono text-xs font-semibold text-gray-400 uppercase tracking-widest mb-3">‚úçÔ∏è Signature</h3>
            <div class="bg-surface-2 rounded-xl border border-neon-green/30 p-4">
              <div class="flex items-center gap-4">
                <img id="ct-signature-img" src="" class="h-16 border border-border rounded" alt="Client signature" />
                <div>
                  <p id="ct-signer-name" class="font-mono text-sm text-white"></p>
                  <p id="ct-signed-at" class="text-xs text-gray-500 font-mono"></p>
                </div>
              </div>
            </div>
          </div>
          </div><!-- /ct-editable-form -->
        </div>
      </div>

      <!-- ‚ïê‚ïê‚ïê Invoice Detail (hidden initially) ‚ïê‚ïê‚ïê -->
      <div id="invoice-detail" class="flex-1 flex flex-col overflow-hidden hidden">
        <div class="p-6 bg-surface-1 border-b border-border">
          <div class="flex items-center justify-between mb-2">
            <div class="flex items-center gap-3">
              <span id="inv-status-badge" class="px-2.5 py-1 rounded-full text-xs font-mono font-semibold bg-gray-800 text-gray-400">DRAFT</span>
              <h2 id="inv-number" class="font-mono text-lg font-bold text-white">üí∞ Invoice</h2>
            </div>
            <div class="flex items-center gap-2">
              <button onclick="saveInvoice()" class="text-xs font-mono px-3 py-1.5 rounded-lg bg-neon-green/10 text-neon-green border border-neon-green/30 hover:bg-neon-green/20 transition">üíæ Save</button>
              <button onclick="sendInvoice()" class="text-xs font-mono px-3 py-1.5 rounded-lg bg-electric/10 text-electric border border-electric/30 hover:bg-electric/20 transition">üìß Send to Client</button>
              <button onclick="payWithPayPal()" class="text-xs font-mono px-3 py-1.5 rounded-lg bg-blue-500/10 text-blue-400 border border-blue-500/30 hover:bg-blue-500/20 transition" title="Generate PayPal.me link (fee passed to client)">üí≥ PayPal Link</button>
              <button onclick="markInvoicePaid()" class="text-xs font-mono px-3 py-1.5 rounded-lg bg-neon-green/10 text-neon-green border border-neon-green/30 hover:bg-neon-green/20 transition">‚úÖ Mark Paid</button>
              <button onclick="downloadInvoicePDF()" class="text-xs font-mono px-3 py-1.5 rounded-lg bg-neon-purple/10 text-neon-purple border border-neon-purple/30 hover:bg-neon-purple/20 transition">üìÑ Download PDF</button>              <button onclick=\"logPastInvoiceEvent()\" class=\"text-xs font-mono px-3 py-1.5 rounded-lg bg-neon-yellow/10 text-neon-yellow border border-neon-yellow/30 hover:bg-neon-yellow/20 transition\" title=\"Record a past event (payment received, sent, etc.)\">üìú Log Event</button>            </div>
          </div>
        </div>
        <div class="flex-1 overflow-y-auto p-6 space-y-6">
          <!-- Client Info -->
          <div class="grid grid-cols-2 gap-4">
            <div class="bg-surface-2 rounded-xl border border-border p-4">
              <label class="text-[0.65rem] font-mono text-gray-600 uppercase tracking-widest mb-1 block">Client Name</label>
              <input id="inv-client-name" class="w-full bg-transparent border-b border-border text-sm text-white font-mono focus:border-electric focus:outline-none py-1" />
            </div>
            <div class="bg-surface-2 rounded-xl border border-border p-4">
              <label class="text-[0.65rem] font-mono text-gray-600 uppercase tracking-widest mb-1 block">Client Email</label>
              <input id="inv-client-email" class="w-full bg-transparent border-b border-border text-sm text-white font-mono focus:border-electric focus:outline-none py-1" />
            </div>
            <div class="bg-surface-2 rounded-xl border border-border p-4">
              <label class="text-[0.65rem] font-mono text-gray-600 uppercase tracking-widest mb-1 block">Payment Method</label>
              <select id="inv-payment-method" class="w-full bg-transparent border-b border-border text-sm text-white font-mono focus:border-electric focus:outline-none py-1">
                <option value="" class="bg-surface">Select...</option>
                <option value="venmo" class="bg-surface">Venmo</option>
                <option value="zelle" class="bg-surface">Zelle</option>
                <option value="paypal" class="bg-surface">PayPal</option>
                <option value="bank" class="bg-surface">Bank Transfer</option>
              </select>
            </div>
            <div class="bg-surface-2 rounded-xl border border-border p-4">
              <label class="text-[0.65rem] font-mono text-gray-600 uppercase tracking-widest mb-1 block">Due Date</label>
              <input id="inv-due-date" type="date" class="w-full bg-transparent border-b border-border text-sm text-white font-mono focus:border-electric focus:outline-none py-1" />
            </div>
          </div>

          <!-- Line Items -->
          <div>
            <div class="flex items-center justify-between mb-3">
              <h3 class="font-mono text-xs font-semibold text-gray-400 uppercase tracking-widest">üì¶ Line Items</h3>
              <button onclick="addInvoiceItem()" class="text-[0.65rem] font-mono px-2 py-1 rounded bg-electric/10 text-electric hover:bg-electric/20 transition">+ Add Item</button>
            </div>
            <div id="inv-items-container" class="space-y-2">
              <!-- Populated by JS -->
            </div>
          </div>

          <!-- Totals -->
          <div class="bg-surface-2 rounded-xl border border-border p-4">
            <div class="grid grid-cols-2 gap-3 text-sm font-mono">
              <div class="text-gray-500">Subtotal</div>
              <div id="inv-subtotal" class="text-right text-white">$0.00</div>
              <div class="text-gray-500">Tax Rate (%)</div>
              <div><input id="inv-tax-rate" type="number" step="0.01" value="0" class="w-full bg-transparent text-right text-white font-mono focus:outline-none" onchange="recalcInvoice()" /></div>
              <div class="text-gray-500">Tax</div>
              <div id="inv-tax-amount" class="text-right text-white">$0.00</div>
              <div class="text-white font-bold text-lg border-t border-border pt-2">Total</div>
              <div id="inv-total" class="text-right text-neon-green font-bold text-lg border-t border-border pt-2">$0.00</div>
            </div>
          </div>

          <!-- Notes -->
          <div>
            <h3 class="font-mono text-xs font-semibold text-gray-400 uppercase tracking-widest mb-3">üìù Notes</h3>
            <textarea id="inv-notes" rows="3" class="w-full bg-surface-2 rounded-xl border border-border p-4 text-sm text-gray-300 font-mono focus:border-electric focus:outline-none resize-none" placeholder="Payment instructions, thank you note..."></textarea>
          </div>

          <!-- Payment Plan -->
          <div class="bg-surface-2 rounded-xl border border-border p-4">
            <div class="flex items-center justify-between mb-4">
              <div class="flex items-center gap-3">
                <h3 class="font-mono text-xs font-semibold text-gray-400 uppercase tracking-widest">üìÖ Payment Plan</h3>
                <label class="flex items-center gap-2 cursor-pointer">
                  <input type="checkbox" id="inv-payment-plan-enabled" onchange="togglePaymentPlan()" class="rounded border-border bg-surface text-electric focus:ring-electric focus:ring-offset-0 w-4 h-4">
                  <span class="text-xs text-gray-500 font-mono">Enable</span>
                </label>
              </div>
              <div id="pp-controls" class="hidden flex items-center gap-2">
                <input type="number" id="pp-num-installments" value="4" min="2" max="36" class="w-16 bg-surface border border-border rounded text-xs text-white font-mono text-center py-1 focus:border-electric focus:outline-none" title="Number of installments" />
                <button onclick="generatePaymentPlan()" class="text-[0.65rem] font-mono px-2 py-1 rounded bg-electric/10 text-electric hover:bg-electric/20 transition">‚ö° Auto-Generate</button>
                <button onclick="addInstallment()" class="text-[0.65rem] font-mono px-2 py-1 rounded bg-neon-green/10 text-neon-green hover:bg-neon-green/20 transition">+ Add</button>
                <button onclick="sendPaymentReminder()" class="text-[0.65rem] font-mono px-2 py-1 rounded bg-neon-yellow/10 text-neon-yellow hover:bg-neon-yellow/20 transition">üîî Send Reminder</button>
              </div>
            </div>
            <div id="pp-summary" class="hidden mb-3">
              <div class="grid grid-cols-3 gap-3 text-center">
                <div class="bg-surface rounded-lg p-2">
                  <div id="pp-paid-count" class="text-neon-green font-mono font-bold text-lg">0</div>
                  <div class="text-[0.6rem] text-gray-600 uppercase">Paid</div>
                </div>
                <div class="bg-surface rounded-lg p-2">
                  <div id="pp-pending-count" class="text-neon-yellow font-mono font-bold text-lg">0</div>
                  <div class="text-[0.6rem] text-gray-600 uppercase">Pending</div>
                </div>
                <div class="bg-surface rounded-lg p-2">
                  <div id="pp-overdue-count" class="text-red-400 font-mono font-bold text-lg">0</div>
                  <div class="text-[0.6rem] text-gray-600 uppercase">Overdue</div>
                </div>
              </div>
            </div>
            <div id="pp-installments" class="hidden space-y-2">
              <!-- Populated by JS -->
            </div>
          </div>

        </div>
      </div>

      <!-- Build Detail (hidden initially) -->
      <div id="build-detail" class="flex-1 flex flex-col overflow-hidden hidden">

        <!-- Build Header -->
        <div id="build-header" class="p-4 bg-surface-1 border-b border-border">
          <div class="flex items-center justify-between mb-3">
            <div class="flex items-center gap-3">
              <span id="build-status-badge" class="px-2.5 py-1 rounded-full text-xs font-mono font-semibold"></span>
              <h2 id="build-client" class="font-mono text-lg font-bold text-white"></h2>
            </div>
            <div class="flex items-center gap-3 text-xs font-mono text-gray-500">
              <span id="build-id-display"></span>
              <span id="build-time"></span>
            </div>
          </div>
          <div id="build-meta" class="flex gap-4 text-xs text-gray-400"></div>
        </div>

        <!-- Step Progress Bar -->
        <div id="step-progress" class="px-6 py-4 bg-surface-2 border-b border-border">
          <div class="flex items-center justify-between max-w-3xl mx-auto">
            <!-- Steps rendered by JS -->
          </div>
        </div>

        <!-- Content Area: Pipeline / AI / Logs -->
        <div class="flex-1 flex flex-col overflow-hidden">

          <!-- Content Tabs -->
          <div class="flex border-b border-border bg-surface-1">
            <button onclick="switchContentTab('pipeline')" id="ctab-pipeline"
              class="px-5 py-2.5 text-xs font-mono font-semibold uppercase tracking-widest border-b-2 border-electric text-electric transition">
              ‚ö° Pipeline
            </button>
            <button onclick="switchContentTab('ai')" id="ctab-ai"
              class="px-5 py-2.5 text-xs font-mono font-semibold uppercase tracking-widest border-b-2 border-transparent text-gray-500 hover:text-gray-300 transition">
              ü§ñ AI Activity
            </button>
            <button onclick="switchContentTab('log')" id="ctab-log"
              class="px-5 py-2.5 text-xs font-mono font-semibold uppercase tracking-widest border-b-2 border-transparent text-gray-500 hover:text-gray-300 transition">
              üìü Log <span id="log-count" class="ml-1 text-gray-600">0</span>
            </button>
            <div class="ml-auto flex items-center gap-2 pr-4">
              <label class="flex items-center gap-1.5 text-xs text-gray-500 cursor-pointer">
                <input type="checkbox" id="auto-scroll" checked class="rounded border-border bg-surface-2 text-electric focus:ring-electric focus:ring-offset-0 w-3.5 h-3.5">
                Auto-scroll
              </label>
            </div>
          </div>

          <!-- ‚ïê‚ïê‚ïê Pipeline Graph View ‚ïê‚ïê‚ïê -->
          <div id="content-pipeline" class="flex-1 overflow-y-auto p-6">
            <div id="pipeline-graph" class="pipeline-container max-w-4xl mx-auto">
              <!-- Rendered by JS -->
              <div class="text-center text-gray-600 text-xs font-mono py-12">Waiting for build to start...</div>
            </div>
          </div>

          <!-- ‚ïê‚ïê‚ïê AI Activity Panel (hidden initially) ‚ïê‚ïê‚ïê -->
          <div id="content-ai" class="flex-1 overflow-y-auto p-3 space-y-3 hidden">
            <div id="ai-panel" class="space-y-3">
              <div class="text-center text-gray-600 text-xs font-mono py-8">No AI activity yet</div>
            </div>
          </div>

          <!-- ‚ïê‚ïê‚ïê Build Log Panel (hidden initially) ‚ïê‚ïê‚ïê -->
          <div id="content-log" class="flex-1 overflow-y-auto p-4 font-mono text-xs leading-relaxed hidden">
            <div id="log-panel">
              <div class="text-gray-600">Waiting for build output...</div>
            </div>
          </div>

        </div>
      </div>
    </main>
  </div>

  <!-- ‚ïê‚ïê‚ïê Login Screen (shown when not authenticated) ‚ïê‚ïê‚ïê -->
  <div id="login-screen" class="fixed inset-0 bg-surface z-[100] flex items-center justify-center">
    <div class="text-center">
      <div class="w-16 h-16 rounded-2xl bg-gradient-to-br from-amd-red to-electric flex items-center justify-center mx-auto mb-6">
        <span class="text-white font-mono font-bold text-2xl">A</span>
      </div>
      <h1 class="font-mono text-2xl font-bold text-white mb-2">AjayaDesign<span class="text-electric">::</span>Admin</h1>
      <p class="text-gray-500 text-sm mb-8">Sign in to access the dashboard</p>
      <button id="google-login-btn" class="inline-flex items-center gap-3 px-6 py-3 bg-white text-gray-800 font-semibold rounded-lg hover:bg-gray-100 transition shadow-lg">
        <svg class="w-5 h-5" viewBox="0 0 24 24"><path d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92a5.06 5.06 0 01-2.2 3.32v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.1z" fill="#4285F4"/><path d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" fill="#34A853"/><path d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" fill="#FBBC05"/><path d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" fill="#EA4335"/></svg>
        Sign in with Google
      </button>
      <p id="login-error" class="text-brand-link text-xs mt-4 hidden"></p>
    </div>
  </div>

  <!-- ‚ïê‚ïê‚ïê Add Client Modal ‚ïê‚ïê‚ïê -->
  <div id="add-client-modal" class="fixed inset-0 z-[100] hidden">
    <!-- Backdrop -->
    <div class="absolute inset-0 bg-black/70 backdrop-blur-sm" onclick="closeAddClientModal()"></div>
    <!-- Modal -->
    <div class="absolute inset-4 md:inset-y-8 md:inset-x-auto md:max-w-2xl md:mx-auto bg-surface-1 rounded-2xl border border-border shadow-2xl flex flex-col overflow-hidden animate-slide-up">
      <!-- Header -->
      <div class="flex items-center justify-between p-5 border-b border-border">
        <h2 class="font-mono font-semibold text-white text-sm">‚ûï Add New Client</h2>
        <button onclick="closeAddClientModal()" class="text-gray-500 hover:text-white transition text-xl leading-none">&times;</button>
      </div>

      <!-- Tabs -->
      <div class="flex border-b border-border">
        <button id="acm-tab-manual" onclick="switchAddClientTab('manual')"
          class="flex-1 py-3 text-xs font-mono font-semibold uppercase tracking-widest text-center border-b-2 border-electric text-electric transition">
          Manual Form
        </button>
        <button id="acm-tab-ai" onclick="switchAddClientTab('ai')"
          class="flex-1 py-3 text-xs font-mono font-semibold uppercase tracking-widest text-center border-b-2 border-transparent text-gray-500 hover:text-gray-300 transition">
          AI Paste &amp; Parse
        </button>
      </div>

      <!-- Scrollable Content -->
      <div class="flex-1 overflow-y-auto p-5 space-y-4">

        <!-- ‚îÄ‚îÄ AI Parse Panel ‚îÄ‚îÄ -->
        <div id="acm-ai-panel" class="hidden space-y-4">
          <p class="text-xs text-gray-400 font-mono">Paste client details below ‚Äî email, text message, notes, anything. AI will extract the fields.</p>
          <textarea id="acm-raw-text" rows="6"
            placeholder="Hey Aj, I run a bakery called Sunrise Bakery in Portland OR. We need a website to showcase our artisan breads..."
            class="w-full px-4 py-3 rounded-lg bg-surface border border-border text-white font-mono text-sm placeholder-gray-600 focus:outline-none focus:border-electric focus:ring-1 focus:ring-electric/50 transition-colors resize-none"></textarea>
          <button onclick="parseWithAI()" id="acm-parse-btn"
            class="flex items-center gap-2 px-4 py-2.5 bg-electric/10 text-electric border border-electric/30 rounded-lg font-mono text-xs font-semibold hover:bg-electric/20 transition">
            ü§ñ Parse with AI
          </button>
          <div id="acm-parse-status" class="hidden text-xs font-mono"></div>
        </div>

        <!-- ‚îÄ‚îÄ Form Fields (shared by Manual and AI-parsed) ‚îÄ‚îÄ -->
        <div id="acm-form-fields">
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <!-- Business Name -->
            <div class="md:col-span-2">
              <label class="block font-mono text-xs text-gray-500 mb-1">Business Name <span class="text-red-400">*</span></label>
              <input id="acm-business-name" type="text" required
                class="w-full px-3 py-2.5 rounded-lg bg-surface border border-border text-white font-mono text-sm placeholder-gray-600 focus:outline-none focus:border-electric transition" placeholder="e.g. Sunrise Bakery" />
            </div>
            <!-- Niche -->
            <div>
              <label class="block font-mono text-xs text-gray-500 mb-1">Niche / Industry <span class="text-red-400">*</span></label>
              <input id="acm-niche" type="text" required
                class="w-full px-3 py-2.5 rounded-lg bg-surface border border-border text-white font-mono text-sm placeholder-gray-600 focus:outline-none focus:border-electric transition" placeholder="e.g. Artisan Bakery" />
            </div>
            <!-- Email -->
            <div>
              <label class="block font-mono text-xs text-gray-500 mb-1">Email <span class="text-red-400">*</span></label>
              <input id="acm-email" type="email" required
                class="w-full px-3 py-2.5 rounded-lg bg-surface border border-border text-white font-mono text-sm placeholder-gray-600 focus:outline-none focus:border-electric transition" placeholder="hello@client.com" />
            </div>
            <!-- Goals -->
            <div class="md:col-span-2">
              <label class="block font-mono text-xs text-gray-500 mb-1">Goals <span class="text-red-400">*</span></label>
              <textarea id="acm-goals" rows="2"
                class="w-full px-3 py-2.5 rounded-lg bg-surface border border-border text-white font-mono text-sm placeholder-gray-600 focus:outline-none focus:border-electric transition resize-none" placeholder="What should the website accomplish?"></textarea>
            </div>
            <!-- Phone -->
            <div>
              <label class="block font-mono text-xs text-gray-500 mb-1">Phone</label>
              <input id="acm-phone" type="tel"
                class="w-full px-3 py-2.5 rounded-lg bg-surface border border-border text-white font-mono text-sm placeholder-gray-600 focus:outline-none focus:border-electric transition" placeholder="(503) 555-1234" />
            </div>
            <!-- Location -->
            <div>
              <label class="block font-mono text-xs text-gray-500 mb-1">Location</label>
              <input id="acm-location" type="text"
                class="w-full px-3 py-2.5 rounded-lg bg-surface border border-border text-white font-mono text-sm placeholder-gray-600 focus:outline-none focus:border-electric transition" placeholder="Portland, OR" />
            </div>
            <!-- Existing Website -->
            <div>
              <label class="block font-mono text-xs text-gray-500 mb-1">Existing Website</label>
              <input id="acm-existing-website" type="url"
                class="w-full px-3 py-2.5 rounded-lg bg-surface border border-border text-white font-mono text-sm placeholder-gray-600 focus:outline-none focus:border-electric transition" placeholder="https://current-site.com" />
            </div>
            <!-- Brand Colors -->
            <div>
              <label class="block font-mono text-xs text-gray-500 mb-1">Brand Colors</label>
              <input id="acm-brand-colors" type="text"
                class="w-full px-3 py-2.5 rounded-lg bg-surface border border-border text-white font-mono text-sm placeholder-gray-600 focus:outline-none focus:border-electric transition" placeholder="Navy blue #1a365d, Gold" />
            </div>
            <!-- Tagline -->
            <div class="md:col-span-2">
              <label class="block font-mono text-xs text-gray-500 mb-1">Tagline / Slogan</label>
              <input id="acm-tagline" type="text"
                class="w-full px-3 py-2.5 rounded-lg bg-surface border border-border text-white font-mono text-sm placeholder-gray-600 focus:outline-none focus:border-electric transition" placeholder="e.g. Fresh Baked Daily Since 1985" />
            </div>
            <!-- Target Audience -->
            <div class="md:col-span-2">
              <label class="block font-mono text-xs text-gray-500 mb-1">Target Audience</label>
              <input id="acm-target-audience" type="text"
                class="w-full px-3 py-2.5 rounded-lg bg-surface border border-border text-white font-mono text-sm placeholder-gray-600 focus:outline-none focus:border-electric transition" placeholder="e.g. Young professionals aged 25-40" />
            </div>
            <!-- Competitor URLs -->
            <div class="md:col-span-2">
              <label class="block font-mono text-xs text-gray-500 mb-1">Competitor URLs</label>
              <textarea id="acm-competitor-urls" rows="2"
                class="w-full px-3 py-2.5 rounded-lg bg-surface border border-border text-white font-mono text-sm placeholder-gray-600 focus:outline-none focus:border-electric transition resize-none" placeholder="One URL per line"></textarea>
            </div>
            <!-- Additional Notes -->
            <div class="md:col-span-2">
              <label class="block font-mono text-xs text-gray-500 mb-1">Additional Notes</label>
              <textarea id="acm-additional-notes" rows="2"
                class="w-full px-3 py-2.5 rounded-lg bg-surface border border-border text-white font-mono text-sm placeholder-gray-600 focus:outline-none focus:border-electric transition resize-none" placeholder="Special hours, certifications, awards..."></textarea>
            </div>
            <!-- Rebuild -->
            <div class="md:col-span-2">
              <label class="flex items-center gap-2 cursor-pointer">
                <input type="checkbox" id="acm-rebuild" class="w-4 h-4 rounded border-border bg-surface text-electric focus:ring-electric/50" />
                <span class="font-mono text-xs text-gray-400">Rebuild existing site</span>
              </label>
            </div>
          </div>
        </div>
      </div>

      <!-- Footer Actions -->
      <div class="p-5 border-t border-border flex items-center justify-between gap-3">
        <button onclick="closeAddClientModal()" class="px-4 py-2.5 text-gray-500 font-mono text-xs hover:text-white transition">Cancel</button>
        <div class="flex gap-3">
          <button onclick="saveNewLead(false)" class="px-4 py-2.5 bg-surface-2 text-gray-300 border border-border rounded-lg font-mono text-xs hover:border-border-glow transition">
            Save Lead Only
          </button>
          <button onclick="saveNewLead(true)" class="px-4 py-2.5 bg-electric/10 text-electric border border-electric/30 rounded-lg font-mono text-xs font-semibold hover:bg-electric/20 transition">
            üöÄ Save &amp; Build
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- ‚ïê‚ïê‚ïê Firebase SDK ‚ïê‚ïê‚ïê -->
  <script src="https://www.gstatic.com/firebasejs/11.4.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/11.4.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/11.4.0/firebase-database-compat.js"></script>
  <script src="../js/firebase-config.js"></script>
  <script>
    window.__firebaseApp = firebase.initializeApp(window.__firebaseConfig);
    window.__auth = firebase.auth();
    window.__db = firebase.database();
  </script>
  <script src="js/pipeline.js"></script>
  <script src="js/admin.js"></script>
  <script src="js/portfolio.js"></script>
  <script src="js/contracts.js"></script>
  <script src="js/invoices.js"></script>
  <script src="js/history.js"></script>
  <!-- jsPDF for PDF generation -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</body>
</html>
